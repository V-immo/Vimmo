<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gratis Account | Vimmo</title>
    <meta name="description"
        content="Maak een gratis Vimmo account aan om woningen te zoeken, opslaan en bezichtigingen aan te vragen.">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100;300;400;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css">
    <link rel="stylesheet" href="style.css">

    <style>
        .account-page {
            min-height: 100vh;
            padding: 120px 0 80px;
            background: linear-gradient(180deg, var(--bg-dark) 0%, var(--bg-section) 50%, var(--bg-light) 100%);
        }

        .register-container {
            max-width: 480px;
            margin: 0 auto;
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 50px 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--glass-border);
        }

        .register-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .register-header .brand {
            font-size: 2rem;
            display: block;
            margin-bottom: 24px;
            text-decoration: none;
        }

        .register-header h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color: var(--text-main);
        }

        .register-header p {
            color: var(--text-muted);
        }

        .free-badge {
            display: inline-block;
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 100px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-main);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-section);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-main);
            font-size: 1rem;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .btn-itsme {
            background: #FF562C;
            color: white;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .btn-itsme:hover {
            background: #e04b25;
        }

        .divider {
            text-align: center;
            color: var(--text-muted);
            margin: 24px 0;
            position: relative;
        }

        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: var(--glass-border);
        }

        .divider::before {
            left: 0;
        }

        .divider::after {
            right: 0;
        }

        .terms {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-align: center;
            margin-top: 24px;
        }

        .terms a {
            color: var(--primary);
        }

        .features-preview {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--bg-section);
            border-radius: var(--radius-md);
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--text-main);
        }

        .feature-item i {
            color: var(--primary);
        }

        /* Verkopen link */
        .verkopen-link {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid var(--glass-border);
        }

        .verkopen-link p {
            color: var(--text-muted);
            margin-bottom: 12px;
            font-size: 0.95rem;
        }

        /* Mobile */
        @media (max-width: 600px) {
            .register-container {
                padding: 40px 24px;
                margin: 0 16px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .features-preview {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <nav class="navbar scrolled">
        <div class="container nav-content">
            <a href="index.html" class="brand"><span style="color: #d63031; font-weight: 400;">V</span> <span
                    style="color: #3d3530; font-weight: 400;">I</span><span
                    style="color: #3d3530; font-weight: 800;">MMO</span></a>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="kopen.html">Te koop</a>
                <a href="huren.html">Te huur</a>
                <a href="nieuwbouw.html">Nieuwbouw</a>
                <a href="contact.html">Contact</a>
            </div>
            <div class="nav-actions">
                <a href="login.html" class="btn btn-glass">Inloggen</a>
                <a href="account.html" class="btn btn-primary">Registreren</a>
            </div>
            <button class="hamburger" onclick="toggleMobileMenu()" aria-label="Menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="mobile-menu">
        <div class="mobile-menu-header">
            <a href="index.html" class="brand"><span style="color: #d63031; font-weight: 400;">V</span> <span
                    style="color: #3d3530; font-weight: 400;">I</span><span
                    style="color: #3d3530; font-weight: 800;">MMO</span></a>
            <button class="close-menu" onclick="toggleMobileMenu()">
                <i class="ri-close-line"></i>
            </button>
        </div>
        <div class="mobile-menu-links">
            <a href="index.html" onclick="toggleMobileMenu()">Home</a>
            <a href="kopen.html" onclick="toggleMobileMenu()">Te koop</a>
            <a href="huren.html" onclick="toggleMobileMenu()">Te huur</a>
            <a href="nieuwbouw.html" onclick="toggleMobileMenu()">Nieuwbouw</a>
            <a href="contact.html" onclick="toggleMobileMenu()">Contact</a>
        </div>
        <div class="mobile-menu-actions">
            <a href="login.html" class="btn btn-glass" style="width: 100%; text-align: center;">Inloggen</a>
            <a href="account.html" class="btn btn-primary" style="width: 100%; text-align: center;">Registreren</a>
        </div>
    </div>

    <main class="account-page">
        <div class="container">
            <div class="register-container">
                <div class="register-header">
                    <a href="index.html" class="brand">
                        <span style="color: #d63031; font-weight: 400;">V</span> <span
                            style="color: #3d3530; font-weight: 800;">IMMO</span>
                    </a>
                    <span class="free-badge"><i class="ri-gift-line"></i> 100% Gratis</span>
                    <h1>Account aanmaken</h1>
                    <p>Vind uw droomwoning sneller met een gratis account</p>
                </div>

                <!-- Account Type Selection -->
                <div class="login-type-section" style="margin-bottom: 30px;">
                    <p class="login-type-title"
                        style="text-align: center; margin-bottom: 16px; color: var(--text-muted);">Ik wil een account
                        voor:</p>
                    <div class="login-types" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                        <button type="button" class="login-type-btn active" data-type="zoeker"
                            onclick="selectRole(this)"
                            style="padding: 16px 12px; background: var(--bg-section); border: 2px solid var(--glass-border); border-radius: var(--radius-md); cursor: pointer; text-align: center; transition: all 0.2s;">
                            <i class="ri-search-line"
                                style="display: block; font-size: 1.5rem; margin-bottom: 8px; color: var(--primary);"></i>
                            <span
                                style="display: block; font-size: 0.85rem; font-weight: 500; color: var(--text-main);">Woningzoeker</span>
                        </button>
                        <button type="button" class="login-type-btn" data-type="particulier" onclick="selectRole(this)"
                            style="padding: 16px 12px; background: var(--bg-section); border: 2px solid var(--glass-border); border-radius: var(--radius-md); cursor: pointer; text-align: center; transition: all 0.2s;">
                            <i class="ri-home-heart-line"
                                style="display: block; font-size: 1.5rem; margin-bottom: 8px; color: var(--primary);"></i>
                            <span
                                style="display: block; font-size: 0.85rem; font-weight: 500; color: var(--text-main);">Particulier</span>
                        </button>
                        <button type="button" class="login-type-btn" data-type="makelaar" onclick="selectRole(this)"
                            style="padding: 16px 12px; background: var(--bg-section); border: 2px solid var(--glass-border); border-radius: var(--radius-md); cursor: pointer; text-align: center; transition: all 0.2s;">
                            <i class="ri-building-2-line"
                                style="display: block; font-size: 1.5rem; margin-bottom: 8px; color: var(--primary);"></i>
                            <span
                                style="display: block; font-size: 0.85rem; font-weight: 500; color: var(--text-main);">Makelaar</span>
                        </button>
                    </div>
                </div>

                <!-- What you get -->
                <div class="features-preview">
                    <div class="feature-item"><i class="ri-heart-line"></i> Woningen opslaan</div>
                    <div class="feature-item"><i class="ri-notification-line"></i> Alerts instellen</div>
                    <div class="feature-item"><i class="ri-calendar-line"></i> Bezichtigingen</div>
                    <div class="feature-item"><i class="ri-message-3-line"></i> Direct contact</div>
                </div>

                <!-- Itsme Button -->
                <button class="btn btn-itsme" onclick="simulateItsme()">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8b/Itsme_logo.svg/1200px-Itsme_logo.svg.png"
                        style="height: 24px; filter: brightness(0) invert(1);">
                    Registreren met itsme
                </button>

                <div class="divider">of met email</div>

                <form class="register-form" id="registerForm" onsubmit="submitRegister(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Voornaam</label>
                            <input type="text" class="form-input" placeholder="Jan" required>
                        </div>
                        <div class="form-group">
                            <label>Achternaam</label>
                            <input type="text" class="form-input" placeholder="Janssens" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>E-mailadres</label>
                        <input type="email" class="form-input" placeholder="jan@voorbeeld.be" required>
                    </div>

                    <div class="form-group">
                        <label>Wachtwoord</label>
                        <input type="password" id="regPassword" class="form-input" placeholder="Minimaal 8 karakters"
                            required>
                    </div>

                    <div class="form-group">
                        <label>Wachtwoord bevestigen</label>
                        <input type="password" id="regPasswordConfirm" class="form-input"
                            placeholder="Herhaal wachtwoord" required>
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 16px;">
                        Gratis account aanmaken
                    </button>

                    <p style="text-align: center; margin-top: 15px; font-size: 0.85rem;">
                        Al een account? <a href="javascript:toggleAuthMode()" id="toggleBtn">Inloggen</a>
                    </p>
                </form>

                <form class="login-form" id="loginForm" onsubmit="submitLogin(event)" style="display: none;">
                    <div class="form-group">
                        <label>E-mailadres</label>
                        <input type="email" id="loginEmail" class="form-input" placeholder="uw@email.be" required>
                    </div>

                    <div class="form-group">
                        <label>Wachtwoord</label>
                        <input type="password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 16px;">
                        Inloggen
                    </button>

                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 15px; text-align: center;">
                        Demo tip: Gebruik 'makelaar@', 'zoeker@' of 'particulier@'
                    </p>

                    <p style="text-align: center; margin-top: 15px; font-size: 0.85rem;">
                        Nog geen account? <a href="javascript:toggleAuthMode()">Registreren</a>
                    </p>
                </form>

                <p class="terms">
                    Door te registreren ga je akkoord met onze
                    <a href="voorwaarden.html">Algemene Voorwaarden</a> en <a href="privacy.html">Privacy Policy</a>
                </p>

                <!-- Link to verkopen -->
                <div class="verkopen-link">
                    <p style="font-weight: 600;">Wilt u uw woning verkopen of verhuren?</p>
                    <a href="verkopen.html" class="btn btn-secondary" style="width: 100%;">WONING PLAATSEN ‚Üí</a>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content"
                style="display: flex; justify-content: space-between; border-bottom: 1px solid var(--glass-border); padding-bottom: 40px;">
                <div class="footer-brand">
                    <h3 class="brand" style="font-size: 2rem; margin-bottom: 20px;"><span
                            style="color: #d63031; font-weight: 400;">V</span> <span
                            style="color: #3d3530; font-weight: 800;">IMMO</span></h3>
                    <p style="color: var(--text-muted); max-width: 280px; font-size: 0.9rem; line-height: 1.6;">Vind een
                        plek die bij je past. Woningen in heel Belgi√´.</p>
                </div>
                <div class="footer-links" style="display: flex; gap: 60px; text-align: right;">
                    <ul>
                        <li style="list-style: none; margin-bottom: 10px; color: var(--primary);">ZOEKEN</li>
                        <li style="list-style: none; margin-bottom: 8px;"><a href="kopen.html"
                                style="color: var(--text-muted); text-decoration: none;">Te koop</a></li>
                        <li style="list-style: none; margin-bottom: 8px;"><a href="huren.html"
                                style="color: var(--text-muted); text-decoration: none;">Te huur</a></li>
                        <li style="list-style: none; margin-bottom: 8px;"><a href="nieuwbouw.html"
                                style="color: var(--text-muted); text-decoration: none;">Nieuwbouw</a></li>
                    </ul>
                    <ul>
                        <li style="list-style: none; margin-bottom: 10px; color: var(--primary);">ACCOUNT</li>
                        <li style="list-style: none; margin-bottom: 8px;"><a href="account.html"
                                style="color: var(--text-muted); text-decoration: none;">Registreren</a></li>
                        <li style="list-style: none; margin-bottom: 8px;"><a href="verkopen.html"
                                style="color: var(--text-muted); text-decoration: none;">Verkopen</a></li>
                        <li style="list-style: none; margin-bottom: 8px;"><a href="contact.html"
                                style="color: var(--text-muted); text-decoration: none;">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom"
                style="text-align: left; padding-top: 30px; display: flex; justify-content: space-between;">
                <p>&copy; 2024 Vimmo.</p>
                <div style="display: flex; gap: 20px; color: var(--text-muted);">
                    <a href="https://instagram.com/vimmo" target="_blank" rel="noopener"
                        style="color: var(--text-muted);"><i class="ri-instagram-line"></i></a>
                    <a href="https://linkedin.com/company/vimmo" target="_blank" rel="noopener"
                        style="color: var(--text-muted);"><i class="ri-linkedin-fill"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <script src="app.js"></script>
    <script>
        // Dynamically determine API URL
        const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? `http://${window.location.hostname}:3000/api`
            : `${window.location.origin}/api`;
        let selectedRole = 'zoeker';

        function selectRole(btn) {
            document.querySelectorAll('.login-type-btn').forEach(b => {
                b.style.borderColor = 'var(--glass-border)';
                b.style.background = 'var(--bg-section)';
                b.classList.remove('active');
            });

            btn.classList.add('active');
            btn.style.borderColor = 'var(--primary)';
            btn.style.background = 'rgba(168, 134, 42, 0.1)';
            selectedRole = btn.dataset.type;
        }

        function toggleAuthMode() {
            const regForm = document.getElementById('registerForm');
            const loginForm = document.getElementById('loginForm');
            const title = document.querySelector('.register-header h1');

            if (regForm.style.display === 'none') {
                regForm.style.display = 'block';
                loginForm.style.display = 'none';
                title.textContent = 'Account aanmaken';
            } else {
                regForm.style.display = 'none';
                loginForm.style.display = 'block';
                title.textContent = 'Inloggen';
            }
        }

        function simulateItsme() {
            alert('itsme¬Æ registratie is nog niet gekoppeld. Gebruik het formulier om te registreren.');
        }

        async function submitRegister(e) {
            e.preventDefault();
            const startTime = performance.now();

            console.log('%c[REGISTER] ========================================', 'color: #22c55e; font-weight: bold');
            console.log('%c[REGISTER] Starting registration process...', 'color: #22c55e');

            const form = e.target;
            const inputs = form.querySelectorAll('input');
            const firstName = inputs[0].value;
            const lastName = inputs[1].value;
            const email = inputs[2].value;
            const password = document.getElementById('regPassword').value;
            const passwordConfirm = document.getElementById('regPasswordConfirm').value;
            const submitBtn = form.querySelector('button[type="submit"]');

            // Log form data (password redacted)
            console.log('%c[REGISTER] Form Data:', 'color: #3b82f6; font-weight: bold');
            console.table({
                firstName: firstName,
                lastName: lastName,
                email: email,
                password: '***' + password.slice(-3) + ` (${password.length} chars)`,
                role: selectedRole
            });

            // Validate locally before sending
            if (!firstName || !lastName || !email || !password) {
                console.error('[REGISTER] ‚ùå Validation failed: Missing required fields');
                console.log({ firstName: !!firstName, lastName: !!lastName, email: !!email, password: !!password });
                showError('Alle velden zijn verplicht');
                return;
            }

            if (password.length < 8) {
                console.error('[REGISTER] ‚ùå Validation failed: Password too short');
                showError('Wachtwoord moet minimaal 8 karakters zijn');
                return;
            }

            if (password !== passwordConfirm) {
                console.error('[REGISTER] ‚ùå Validation failed: Passwords do not match');
                showError('Wachtwoorden komen niet overeen');
                return;
            }

            console.log('%c[REGISTER] ‚úì Local validation passed', 'color: #22c55e');

            // Show loading
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Bezig...';
            submitBtn.disabled = true;

            const requestBody = {
                firstName,
                lastName,
                email,
                password,
                role: selectedRole
            };

            console.log('%c[REGISTER] Sending API request...', 'color: #f59e0b');
            console.log('[REGISTER] URL:', `${API_URL}/auth/register`);
            console.log('[REGISTER] Method: POST');
            console.log('[REGISTER] Body:', { ...requestBody, password: '[REDACTED]' });

            try {
                const response = await fetch(`${API_URL}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestBody)
                });

                const endTime = performance.now();
                const duration = (endTime - startTime).toFixed(2);

                console.log('%c[REGISTER] Response received:', 'color: #8b5cf6; font-weight: bold');
                console.log('[REGISTER] Status:', response.status, response.statusText);
                console.log('[REGISTER] Duration:', duration + 'ms');

                const responseText = await response.text();
                let data;
                try {
                    data = JSON.parse(responseText);
                } catch (e) {
                    console.error('[REGISTER] Server returned non-JSON response:', responseText);
                    showError('Server Fout: ' + responseText.substring(0, 100));
                    return;
                }

                console.log('[REGISTER] Response data:', data);

                if (response.ok) {
                    console.log('%c[REGISTER] ‚úÖ SUCCESS - Account created!', 'color: #22c55e; font-weight: bold; font-size: 14px');
                    console.log('[REGISTER] User ID:', data.userId);
                    console.log('[REGISTER] Email sent:', data.emailSent);
                    // Show success message
                    showSuccess(email);
                } else {
                    console.error('%c[REGISTER] ‚ùå FAILED - Server returned error', 'color: #ef4444; font-weight: bold');
                    console.error('[REGISTER] Error:', data.error);
                    showError(data.error);
                }
            } catch (error) {
                const endTime = performance.now();
                const duration = (endTime - startTime).toFixed(2);

                console.error('%c[REGISTER] ‚ùå NETWORK ERROR', 'color: #ef4444; font-weight: bold; font-size: 14px');
                console.error('[REGISTER] Duration before failure:', duration + 'ms');
                console.error('[REGISTER] Error type:', error.name);
                console.error('[REGISTER] Error message:', error.message);
                console.error('[REGISTER] Full error:', error);

                // Check specific error types
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    console.error('[REGISTER] üí° Hint: Is the backend server running on', API_URL + '?');
                }

                showError('Kan geen verbinding maken met de server. Probeer het later opnieuw.');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                console.log('%c[REGISTER] ========================================', 'color: #22c55e; font-weight: bold');
            }
        }

        function showSuccess(email) {
            const container = document.querySelector('.register-container');
            container.innerHTML = `
                <div style="text-align: center; padding: 40px 0;">
                    <div style="width: 80px; height: 80px; background: rgba(34, 197, 94, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 24px;">
                        <i class="ri-mail-check-line" style="font-size: 2.5rem; color: #22c55e;"></i>
                    </div>
                    <h2 style="font-size: 1.5rem; margin-bottom: 12px; color: var(--text-main);">Check je email!</h2>
                    <p style="color: var(--text-muted); margin-bottom: 24px;">
                        We hebben een verificatie link gestuurd naar<br>
                        <strong style="color: var(--text-main);">${email}</strong>
                    </p>
                    <p style="color: var(--text-muted); font-size: 0.9rem;">
                        Klik op de link in de email om je account te activeren.<br>
                        Check ook je spam folder.
                    </p>
                    <div style="margin-top: 32px;">
                        <a href="login.html" class="btn btn-primary" style="padding: 14px 32px;">Naar inloggen</a>
                    </div>
                </div>
            `;
        }

        function showError(message) {
            let errorEl = document.querySelector('.register-error');
            if (!errorEl) {
                errorEl = document.createElement('div');
                errorEl.className = 'register-error';
                errorEl.style.cssText = 'background: rgba(239, 68, 68, 0.1); color: #ef4444; padding: 12px 16px; border-radius: 8px; margin-bottom: 16px; font-size: 0.9rem;';
                const form = document.getElementById('registerForm');
                form.insertBefore(errorEl, form.firstChild);
            }
            errorEl.innerHTML = `<i class="ri-error-warning-line"></i> ${message}`;
            errorEl.style.display = 'block';
        }

        async function submitLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value.toLowerCase();
            const password = e.target.querySelectorAll('input')[1].value;
            const submitBtn = e.target.querySelector('button[type="submit"]');

            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Bezig...';
            submitBtn.disabled = true;

            try {
                const response = await fetch(`${API_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();

                if (response.ok) {
                    localStorage.setItem('authToken', data.token);
                    localStorage.setItem('userRole', data.user.role);
                    localStorage.setItem('userName', data.user.firstName);

                    switch (data.user.role) {
                        case 'zoeker':
                            window.location.href = 'dashboard-zoeker.html';
                            break;
                        case 'particulier':
                            window.location.href = 'dashboard-particulier.html';
                            break;
                        case 'makelaar':
                            window.location.href = 'dashboard-makelaars.html';
                            break;
                        default:
                            window.location.href = 'dashboard-zoeker.html';
                    }
                } else {
                    alert(data.error);
                }
            } catch (error) {
                alert('Kan geen verbinding maken met de server.');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        }
    </script>
</body>

</html>