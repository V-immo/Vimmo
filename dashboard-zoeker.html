<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zoeker Dashboard | Vimmo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@100;300;400;600;700;800&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css">
    <link rel="stylesheet" href="style.css?v=1.1">
    <style>
        .luxury-hero {
            position: relative;
            height: 350px;
            border-radius: 30px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .luxury-hero img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .luxury-hero-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.6), transparent);
            padding: 50px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            color: white;
        }

        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 25px;
            }
        }
    </style>
</head>

<body class="role-zoeker">
    <div class="dashboard-zoeker">
        <!-- Mobile Toggle -->
        <button class="zoeker-mobile-toggle" style="display: none;">
            <i class="ri-menu-line"></i>
        </button>

        <!-- Sidebar -->
        <aside class="sidebar">
            <a href="index.html" class="sidebar-brand">
                <span class="logo-v">V</span><span class="logo-i">I</span><span class="logo-mmo">MMO</span>
            </a>

            <nav class="sidebar-nav">
                <a href="dashboard-zoeker.html" class="nav-item active">
                    <i class="ri-dashboard-line"></i> Overzicht
                </a>
                <a href="opgeslagen-zoeker.html" class="nav-item">
                    <i class="ri-heart-line"></i> Favorieten
                </a>
                <a href="agenda-zoeker.html" class="nav-item">
                    <i class="ri-calendar-check-line"></i> Agenda
                    <span
                        style="margin-left: auto; background: #ef4444; color: white; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 0.7rem; font-weight: 800;">1</span>
                </a>
                <a href="berichten-zoeker.html" class="nav-item">
                    <i class="ri-message-3-line"></i> Berichten
                    <span
                        style="margin-left: auto; background: var(--primary-zoeker); color: white; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 0.7rem; font-weight: 800;">2</span>
                </a>
                <a href="zoekopdrachten-zoeker.html" class="nav-item">
                    <i class="ri-search-line"></i> Zoekopdrachten
                </a>

                <div style="margin: 25px 0 15px; border-top: 1px solid rgba(0,0,0,0.05);"></div>

                <a href="instellingen-zoeker.html" class="nav-item" style="opacity: 0.7;">
                    <i class="ri-settings-3-line"></i> Instellingen
                </a>
                <a href="javascript:logout()" class="nav-item" style="opacity: 0.7;">
                    <i class="ri-logout-box-line"></i> Uitloggen
                </a>

                <div class="sidebar-user">
                    <div class="user-avatar" style="background: rgba(139, 92, 246, 0.1); color: var(--primary-zoeker);">
                        AK</div>
                    <div class="user-info">
                        <div style="font-size: 0.85rem; font-weight: 800; color: var(--text-main);">Anouk Kerstens</div>
                        <div style="font-size: 0.7rem; font-weight: 600; color: var(--text-muted);">Woningzoeker</div>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Luxury Hero Section -->
            <div class="luxury-hero">
                <img src="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=1200&q=80" alt="Luxury Home">
                <div class="luxury-hero-overlay">
                    <div style="margin-bottom: auto;">
                        <span class="glass-panel"
                            style="padding: 8px 16px; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; color: white; border: 1px solid rgba(255,255,255,0.3);">
                            <i class="ri-magic-line" style="color: #fbbf24;"></i> Gepersonaliseerd
                        </span>
                    </div>
                    <h1 style="font-size: 3rem; margin-bottom: 10px; font-weight: 800;">Welkom terug, Anouk</h1>
                    <p style="font-size: 1.2rem; font-weight: 500; opacity: 0.9; margin-bottom: 40px;">
                        We hebben 12 nieuwe woningen gevonden die perfect bij uw zoekprofiel passen.
                    </p>

                    <div style="display: flex; gap: 40px;">
                        <div class="glass-panel"
                            style="padding: 15px 30px; text-align: center; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);">
                            <div id="hero-fav-count" style="font-size: 1.8rem; font-weight: 800;">7</div>
                            <div
                                style="font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; opacity: 0.8; font-weight: 700;">
                                Favorieten</div>
                        </div>
                        <div class="glass-panel"
                            style="padding: 15px 30px; text-align: center; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);">
                            <div style="font-size: 1.8rem; font-weight: 800;">4</div>
                            <div
                                style="font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; opacity: 0.8; font-weight: 700;">
                                Zoekopdrachten</div>
                        </div>
                        <div class="glass-panel"
                            style="padding: 15px 30px; text-align: center; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);">
                            <div id="hero-next-date" style="font-size: 1.8rem; font-weight: 800;">--:--</div>
                            <div
                                style="font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; opacity: 0.8; font-weight: 700;">
                                Volgende Bezichtiging</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions Panel -->
            <div class="glass-panel"
                style="margin-bottom: 30px; padding: 25px; display: flex; justify-content: space-between; align-items: center; border: 1px solid white;">
                <div style="display: flex; gap: 15px;">
                    <button class="btn" onclick="window.location.href='index.html#filters'"
                        style="background: var(--primary-zoeker); color: white; display: flex; align-items: center; gap: 10px; font-weight: 700; padding: 12px 25px; border-radius: 14px; border: none; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.2);">
                        <i class="ri-search-2-line"></i> Nieuwe Zoekopdracht
                    </button>
                    <button class="btn glass-panel" onclick="window.location.href='opgeslagen-zoeker.html'"
                        style="display: flex; align-items: center; gap: 10px; font-weight: 700; background: white; padding: 12px 25px; border-radius: 14px; border: 1px solid #e2e8f0; cursor: pointer; transition: all 0.3s;">
                        <i class="ri-heart-line"></i> Mijn Favorieten
                    </button>
                </div>
                <div style="text-align: right;">
                    <div
                        style="font-size: 0.75rem; color: var(--text-muted); font-weight: 700; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 0.5px;">
                        Zoekstatus</div>
                    <span
                        style="background: rgba(139, 92, 246, 0.1); color: var(--primary-zoeker); padding: 8px 20px; border-radius: 100px; font-size: 0.85rem; font-weight: 800; border: 1px solid rgba(139, 92, 246, 0.2);">
                        <i class="ri-checkbox-circle-fill"></i> Account Geverifieerd
                    </span>
                </div>
            </div>

            <div class="dashboard-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <!-- Opgeslagen Woningen -->
                <div class="card glass-panel" id="opgeslagen" style="border: none; padding: 30px;">
                    <div class="card-header"
                        style="border-bottom: 1px solid rgba(139, 92, 246, 0.1); padding-bottom: 15px; margin-bottom: 20px;">
                        <h2 class="card-title" style="color: var(--primary-zoeker); font-weight: 800;">
                            <i class="ri-heart-fill"></i> Favorieten
                        </h2>
                        <a href="opgeslagen-zoeker.html"
                            style="color: var(--primary-zoeker); font-weight: 700; font-size: 0.9rem;">Bekijk alle</a>
                    </div>

                    <div id="favorites-container" style="display: flex; flex-direction: column; gap: 15px;">
                        <!-- Loaded via JS -->
                    </div>
                </div>

                <!-- Agenda Woningen -->
                <div class="card glass-panel" id="agenda" style="border: none; padding: 30px;">
                    <div class="card-header"
                        style="border-bottom: 1px solid rgba(139, 92, 246, 0.1); padding-bottom: 15px; margin-bottom: 20px;">
                        <h2 class="card-title" style="color: var(--primary-zoeker); font-weight: 800;">
                            <i class="ri-calendar-check-line"></i> Agenda
                        </h2>
                        <a href="agenda-zoeker.html"
                            style="color: var(--primary-zoeker); font-weight: 700; font-size: 0.9rem;">Volledige
                            agenda</a>
                    </div>

                    <div id="agenda-container" style="display: flex; flex-direction: column; gap: 15px;">
                        <!-- Loaded via JS -->
                    </div>
                </div>

                <!-- Berichten Preview -->
                <div class="card glass-panel" style="border: none; padding: 30px; grid-column: span 2;">
                    <div class="card-header"
                        style="border-bottom: 1px solid rgba(139, 92, 246, 0.1); padding-bottom: 15px; margin-bottom: 20px;">
                        <h2 class="card-title" style="color: var(--primary-zoeker); font-weight: 800;">
                            <i class="ri-message-3-line"></i> Laatste Berichten
                        </h2>
                        <a href="berichten-zoeker.html"
                            style="color: var(--primary-zoeker); font-weight: 700; font-size: 0.9rem;">Alle chats</a>
                    </div>

                    <div id="messages-container"
                        style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                        <!-- Hardcoded for now but styled glass -->
                        <div class="glass-panel"
                            style="background: white; border: 1px solid #f1f5f9; padding: 25px; border-radius: 20px; position: relative; cursor: pointer; transition: all 0.3s;"
                            onclick="window.location.href='berichten-zoeker.html?id=1'">
                            <span
                                style="position: absolute; top: 15px; right: 15px; width: 12px; height: 12px; background: var(--primary-zoeker); border-radius: 50%; border: 2px solid white;"></span>
                            <div style="font-weight: 800; font-size: 1.1rem; margin-bottom: 8px;">Jan de Vries</div>
                            <p
                                style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 15px;">
                                De bezichtiging voor morgen is bevestigd. Tot dan!</p>
                            <div style="font-size: 0.75rem; color: var(--text-muted); font-weight: 600;">vandaag, 14:20
                            </div>
                        </div>

                        <div class="glass-panel"
                            style="background: white; border: 1px solid #f1f5f9; padding: 25px; border-radius: 20px; cursor: pointer; transition: all 0.3s;"
                            onclick="window.location.href='berichten-zoeker.html?id=2'">
                            <div style="font-weight: 800; font-size: 1.1rem; margin-bottom: 8px;">Sophie Dubois</div>
                            <p
                                style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 15px;">
                                Bedankt voor uw interesse. Wanneer schikt het u?</p>
                            <div style="font-size: 0.75rem; color: var(--text-muted); font-weight: 600;">gisteren, 11:05
                            </div>
                        </div>

                        <div class="glass-panel"
                            style="background: white; border: 1px solid #f1f5f9; padding: 25px; border-radius: 20px; cursor: pointer; transition: all 0.3s;"
                            onclick="window.location.href='berichten-zoeker.html?id=3'">
                            <div style="font-weight: 800; font-size: 1.1rem; margin-bottom: 8px;">Premium Homes</div>
                            <p
                                style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 15px;">
                                Het dossier voor de Scheldestraat is bijgewerkt.</p>
                            <div style="font-size: 0.75rem; color: var(--text-muted); font-weight: 600;">18 dec, 16:45
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="propertyContext.js"></script>
    <script src="dashboard-nav.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            loadZoekerData();
        });

        function loadZoekerData() {
            if (!window.propertyContext) return;

            // 1. Load Agenda/Applications
            const allRequests = propertyContext.getAllData('requests');
            const myApplications = [];
            const allProps = propertyContext.getAll();

            Object.keys(allRequests).forEach(propId => {
                const requests = allRequests[propId];
                if (requests) {
                    requests.forEach(req => {
                        // In a real app, match by userId. Here we match by name for demo.
                        if (req.name === 'Anouk Kerstens' || req.name === 'Emma Peeters') {
                            myApplications.push({
                                ...req,
                                propertyName: allProps[propId]?.name || 'Onbekende Woning',
                                propertyEmoji: allProps[propId]?.emoji || 'üè†'
                            });
                        }
                    });
                }
            });

            renderAgenda(myApplications);
            renderFavorites(allProps);
            renderStats(myApplications);
        }

        function renderAgenda(apps) {
            const container = document.getElementById('agenda-container');
            if (!container) return;

            if (apps.length === 0) {
                container.innerHTML = '<p style="text-align:center; padding:20px; color:var(--text-muted);">Je hebt nog geen actieve aanvragen of bezichtigingen.</p>';
                return;
            }

            container.innerHTML = apps.map(app => {
                const isConfirmed = app.status === 'Voltooid' || app.status === 'Bevestigd';
                const isPending = app.status === 'In behandeling' || app.status === 'Nieuw';

                const statusColor = isConfirmed ? '#10b981' : (isPending ? '#f59e0b' : '#64748b');
                const statusBg = isConfirmed ? 'rgba(16, 185, 129, 0.1)' : (isPending ? 'rgba(245, 158, 11, 0.1)' : 'rgba(100, 116, 139, 0.1)');

                return `
                    <div class="glass-panel" style="background: white; border-radius: 20px; padding: 15px; border: 1px solid #f1f5f9; display: flex; gap: 15px; align-items: center; cursor: pointer; transition: all 0.3s;" onclick="window.location.href='berichten-zoeker.html?id=${app.id}'" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='none'">
                        <div style="background: var(--primary-zoeker); color: white; padding: 10px; border-radius: 14px; min-width: 60px; text-align: center;">
                            <div style="font-size: 1.4rem; font-weight: 800;">${app.date ? app.date.split(' ')[0] : '18'}</div>
                            <div style="font-size: 0.7rem; font-weight: 700; text-transform: uppercase;">Dec</div>
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 800; font-size: 1rem;">${app.propertyEmoji} ${app.propertyName}</div>
                            <div style="font-size: 0.85rem; color: var(--text-muted); font-weight: 500;">
                                <i class="ri-time-line"></i> ${app.time} - ${app.type}
                            </div>
                        </div>
                        <span style="background: ${statusBg}; color: ${statusColor}; padding: 6px 12px; border-radius: 100px; font-size: 0.75rem; font-weight: 800;">
                            ${app.status || 'Nieuw'}
                        </span>
                    </div>
                `;
            }).join('');
        }

        function renderFavorites(allProps) {
            const container = document.getElementById('favorites-container');
            const favoriteIds = propertyContext.getFavorites();

            if (!container) return;

            if (favoriteIds.length === 0) {
                container.innerHTML = '<p style="text-align:center; padding:20px; color:var(--text-muted);">Nog geen favorieten. Klik op het hartje bij een woning!</p>';
                return;
            }

            // Update header count
            const countHeader = document.querySelector('#opgeslagen a');
            if (countHeader) countHeader.textContent = `Bekijk alle (${favoriteIds.length})`;
            document.getElementById('hero-fav-count').textContent = favoriteIds.length;

            container.innerHTML = favoriteIds.map(id => {
                const p = allProps[id];
                if (!p) return '';
                const advertentie = propertyContext.getData('advertentie', id) || {};

                return `
                    <a href="property.html" class="glass-panel"
                        style="text-decoration: none; color: inherit; background: white; border: 1px solid #f1f5f9; padding: 12px; display: flex; gap: 15px; align-items: center; border-radius: 16px; transition: transform 0.3s ease;">
                        <div style="font-size: 1.8rem; width: 60px; height: 60px; background: #f8fafc; border-radius: 12px; display: flex; align-items: center; justify-content: center;">${p.emoji}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 900; color: var(--primary-zoeker); font-size: 1.2rem;">‚Ç¨ ${advertentie.price ? advertentie.price.toLocaleString() : '---'}</div>
                            <div style="font-size: 0.95rem; font-weight: 600;">${p.name}</div>
                        </div>
                        <i class="ri-arrow-right-s-line" style="color: var(--text-muted); font-size: 1.5rem;"></i>
                    </a>
                `;
            }).join('');
        }

        function renderStats(apps) {
            const nextViewing = apps.find(a => a.type === 'Bezichtiging');
            if (nextViewing) {
                document.getElementById('hero-next-date').textContent = nextViewing.time.split(' - ')[0];
            }
        }
    </script>
</body>

</html>